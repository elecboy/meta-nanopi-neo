From ff128f996a942428fc0f5745af876eba4faa7859 Mon Sep 17 00:00:00 2001
From: changzhijie <elecboy@126.com>
Date: Tue, 19 Jun 2018 09:58:34 +0800
Subject: [PATCH 04/13] add cpufreq to neo air

---
 arch/arm/boot/dts/sun8i-h3-nanopi-neo-air.dts | 45 +++++++++++++++++++
 1 file changed, 85 insertions(+)

diff --git a/arch/arm/boot/dts/sun8i-h3-nanopi-neo-air.dts b/arch/arm/boot/dts/sun8i-h3-nanopi-neo-air.dts
index 84724fec6469..9ffd8bc95ac8 100644
--- a/arch/arm/boot/dts/sun8i-h3-nanopi-neo-air.dts
+++ b/arch/arm/boot/dts/sun8i-h3-nanopi-neo-air.dts
@@ -45,6 +45,8 @@
 #include "sunxi-common-regulators.dtsi"

 #include <dt-bindings/gpio/gpio.h>
+#include <dt-bindings/input/input.h>
+#include <dt-bindings/thermal/thermal.h>

 / {
 	model = "FriendlyARM NanoPi NEO Air";
@@ -81,6 +83,49 @@
 	aliases {
 		serial3 = &uart3;
 		};
+
+  vdd_cpux: gpio-regulator {
+    compatible = "regulator-gpio";
+
+    pinctrl-names = "default";
+    pinctrl-0 = <&vdd_cpux_r_opc>;
+
+    regulator-name = "vdd-cpux";
+    regulator-type = "voltage";
+    regulator-boot-on;
+    regulator-always-on;
+    regulator-min-microvolt = <1100000>;
+    regulator-max-microvolt = <1300000>;
+    regulator-ramp-delay = <50>; /* 4ms */
+
+    gpios = <&r_pio 0 6 GPIO_ACTIVE_HIGH>;
+    gpios-states = <0x1>;
+    states = <1100000 0x0
+              1300000 0x1>;
+  };
+};
+
+&cpu0 {
+        operating-points = <
+                1008000 1300000
+                912000  1100000
+                816000  1100000
+                624000  1100000
+                480000  1100000
+                312000  1100000
+                240000  1100000
+                >;
+        #cooling-cells = <2>;
+        cooling-min-level = <0>;
+        cooling-max-level = <6>;
+        cpu0-supply = <&vdd_cpux>;
+};
+
+&r_pio {
+       vdd_cpux_r_opc: regulator_pins@0 {
+               pins = "PL6";
+               function = "gpio_out";
+       };
 };

 &mmc0 {
--
2.17.1
